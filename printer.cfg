#######################
### INCLUDE CONFIGS ###
#######################
[include pins_BTT_SKR1.4.cfg]
[include reprap_128x64_fullgraphic.cfg]
# [include tmc2130.cfg]
[include tmc2209.cfg]
[include display_menu.cfg]
[include webui_macros.cfg]
[include macros.cfg]
[include pa_calibrate.cfg]
[include shell_cmd.cfg]

########################
### GENERAL SETTINGS ###
########################
[printer]
kinematics: cartesian

[mcu]
##serial: /dev/ttyAMA0
serial: /dev/serial/by-id/usb-Klipper_lpc1769_1580FF0C22813AAF9F0D6A5CC72000F5-if00
baud: 250000
restart_method: command

[virtual_sdcard]
path: ~/gcode_files

##########################################
### PROBING / LEVELING / MESH SETTINGS ###
##########################################
# Probe specs:
# - Model: IPF KN120120
# - Capacitive, PNP, 10-35V, M12x1, 60mm length

[safe_z_home]
home_xy_position: 67.25, 90.5
speed: 120
z_hop: 2.0
z_hop_speed: 16.0

[probe]
pin: ^!P0.10
x_offset: 41.7495
y_offset: 0.0
z_offset: 1.725

speed: 2.5
samples: 3
sample_retract_dist: 3
lift_speed: 5.0
samples_result: average
samples_tolerance: 0.15
samples_tolerance_retries: 2

[homing_heaters]
steppers: stepper_z
heaters: extruder, heater_bed

[bed_screws]
screw1: 5, 0
screw1_name: front_left
screw2: 5, 181
screw2_name: back_left
screw3: 210, 90.5
screw3_name: center_right
horizontal_move_z: 5
probe_height: 0
speed: 50
probe_speed: 5

[bed_mesh]
mesh_min: 52,10
mesh_max: 208, 171
probe_count: 10, 10
mesh_pps: 5,5
algorithm: bicubic
bicubic_tension: 0.2
speed: 120
horizontal_move_z: 5
fade_start: 1.0
fade_end: 10.0

#####################
### MISC SETTINGS ###
#####################

[force_move]
enable_force_move: True

[gcode_arcs]
# resolution lower than 0.4 causes a high load on a pi zero w.
resolution: 0.4

[firmware_retraction]
# only use fw retraction for retract calibration and
# make sure to enable fw retraction in slicer.
retract_length: 0
retract_speed: 1
unretract_speed: 1
unretract_extra_length: 0

[heater_fan extruder0]
pin: P2.0
fan_speed: 1.0
heater: extruder
## start extruder-fan on heating or if heater_temp > 50Â°C
heater_temp: 50.0
max_power: 1.0
## keep fan running on emergency shutdown
shutdown_speed: 1.0

[temperature_sensor pi_zero_2]
sensor_type: temperature_host
sensor_path: /sys/class/thermal/thermal_zone0/temp

#########################
### EXTRUDER SETTINGS ###
#########################
### PID Tuning command:
# PID_CALIBRATE HEATER=extruder TARGET=240
# PID_CALIBRATE HEATER=heater_bed TARGET=60

### Titan Extruder
# [extruder]
# rotation_distance: 7.80290014

### Voron M4
# [extruder]
# rotation_distance: 5.686753622

### Sherpa Mini
[extruder]
filament_diameter: 1.750

rotation_distance: 22.99507188
gear_ratio: 50:10

max_extrude_only_distance: 120.0
max_extrude_only_velocity: 75.0
max_extrude_only_accel: 10000
instantaneous_corner_velocity: 1.000

#######################
### HOTEND SETTINGS ###
#######################

### Airbrush 0.5mm + Steel PTFE
# [extruder]
# nozzle_diameter: 0.500
# max_temp: 255
# pid_Kp: 26.707
# pid_Ki: 1.272
# pid_Kd: 140.212

### Airbrush 0.5mm + TL titanium heatbreak
# [extruder]
# nozzle_diameter: 0.500
# max_temp: 275
# pid_Kp: 24.862
# pid_Ki: 1.151
# pid_Kd: 134.255

### MaPa V6 0.4mm + TL titanium heatbreak
[extruder]
nozzle_diameter: 0.400
max_temp: 275
pid_Kp=22.642
pid_Ki=0.899
pid_Kd=142.647

########################
### HEATBED SETTINGS ###
########################

### Anet A8 stock HB
[heater_bed]
max_temp: 120
pid_Kp: 72.714
pid_Ki: 1.293
pid_Kd: 1022.542

########################
### MACHINE SETTINGS ###
########################
[printer]
max_velocity: 250
max_accel: 4000
max_accel_to_decel: 2000
max_z_velocity: 8
max_z_accel: 16
square_corner_velocity: 5

# [input_shaper]
# shaper_freq_x: 67.04
# shaper_freq_y: 66.67
# shaper_type: ei

[stepper_x]
full_steps_per_rotation: 200
rotation_distance: 32
microsteps: 16

position_min: -15.5
position_max: 218
position_endstop: -15.5

homing_speed: 80
second_homing_speed: 15
homing_retract_dist: 5.0

[stepper_y]
full_steps_per_rotation: 200
rotation_distance: 32
microsteps: 16

position_min: -17.5
position_max: 181
position_endstop: 181

homing_speed: 80
second_homing_speed: 15
homing_retract_dist: 5.0

[stepper_z]
full_steps_per_rotation: 200
rotation_distance: 2
microsteps: 16

position_min: -2
position_max: 240
#position_endstop: 0

homing_speed: 5
second_homing_speed: 2
homing_retract_dist: 2.0

[extruder]
full_steps_per_rotation: 200
microsteps: 16

control: pid
sensor_type: ATC Semitec 104GT-2

min_temp: 0
max_temp: 285
min_extrude_temp: 0

[heater_bed]
min_temp: 0
max_temp: 130
sensor_type: ATC Semitec 104GT-2
control: pid

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.206875, -0.193750, -0.181250, -0.172708, -0.179792, -0.201250, -0.240000, -0.277083, -0.324167, -0.381042
#*# 	-0.171250, -0.157083, -0.142917, -0.132708, -0.139375, -0.163125, -0.199375, -0.238750, -0.288750, -0.346042
#*# 	-0.147917, -0.132500, -0.116250, -0.108125, -0.115417, -0.142292, -0.186458, -0.229583, -0.284167, -0.346875
#*# 	-0.132917, -0.114167, -0.096667, -0.074792, -0.078333, -0.107083, -0.148750, -0.196667, -0.256875, -0.330833
#*# 	-0.107083, -0.076875, -0.052708, -0.027083, -0.029167, -0.059375, -0.106875, -0.153333, -0.212708, -0.294583
#*# 	-0.076250, -0.043542, -0.008125, 0.019375, 0.017708, -0.013958, -0.059167, -0.105208, -0.166250, -0.246458
#*# 	-0.061042, -0.014375, 0.023750, 0.054792, 0.054583, 0.028542, -0.008750, -0.051875, -0.103542, -0.170208
#*# 	-0.054583, -0.004167, 0.035000, 0.071667, 0.073333, 0.060208, 0.024167, -0.013333, -0.061875, -0.120625
#*# 	-0.045417, 0.012500, 0.053125, 0.085625, 0.094375, 0.082917, 0.052292, 0.016250, -0.025417, -0.078125
#*# 	-0.023958, 0.031250, 0.082917, 0.126042, 0.139792, 0.130625, 0.102708, 0.064375, 0.023958, -0.026667
#*# tension = 0.2
#*# min_x = 51.9995
#*# algo = bicubic
#*# y_count = 10
#*# mesh_y_pps = 5
#*# min_y = 10.0
#*# x_count = 10
#*# max_y = 170.92
#*# mesh_x_pps = 5
#*# max_x = 207.9695
